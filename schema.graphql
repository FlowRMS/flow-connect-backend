input CompanyInput {
  name: String!
  companySourceType: CompanyType!
  website: String
  phone: String
  tags: [String!]
  parentCompanyId: UUID
}

type CompanyLandingPage implements LandingPageInterfaceBase {
  id: UUID!
  createdAt: datetime!
  createdBy: String!
  name: String!
  companySourceType: String!
  website: String
  phone: String
}

type CompanyResponse {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  name: String!
  companySourceType: CompanyType!
  website: String
  phone: String
  tags: [String!]
  parentCompanyId: UUID
}

enum CompanyType {
  CUSTOMER
  MANUFACTURER
}

input ContactInput {
  firstName: String!
  lastName: String!
  email: String
  phone: String
  role: String
  territory: String
  tags: [String!]
  notes: String
  companyId: UUID
}

type ContactLandingPage implements LandingPageInterfaceBase {
  id: UUID!
  createdAt: datetime!
  createdBy: String!
  firstName: String!
  lastName: String!
  email: String
  phone: String
  role: String
  companyName: String
}

type ContactResponse {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  firstName: String!
  lastName: String!
  email: String
  phone: String
  role: String
  territory: String
  tags: [String!]
  notes: String
  companyId: UUID
}

type CustomerResponse {
  id: UUID!
  companyName: String!
  parentId: UUID
  insideRepId: UUID
}

"""Date (isoformat)"""
scalar Date

scalar Decimal

input DeleteLinkByEntitiesInput {
  sourceEntityType: EntityType!
  sourceEntityId: UUID!
  targetEntityType: EntityType!
  targetEntityId: UUID!
}

enum EntityType {
  JOB
  TASK
  CONTACT
  COMPANY
  NOTE
}

type FactoryResponse {
  id: UUID!
  title: String!
}

input Filter {
  columnName: String!
  operator: FilterOperator!
  value: String = null
  values: [String!] = null
}

enum FilterOperator {
  EQ
  NE
  GT
  GTE
  LT
  LTE
  LIKE
  ILIKE
  BEGINS_WITH
  ENDS_WITH
  IN
  NOT_IN
  IS_NULL
  IS_NOT_NULL
}

type GenericLandingPage {
  records: [LandingRecord!]!
  total: Int!
}

input JobInput {
  jobName: String!
  statusId: UUID!
  startDate: Date
  endDate: Date
  jobOwnerId: UUID
  description: String
  jobType: String
  structuralDetails: String
  structuralInformation: String
  additionalInformation: String
  requesterId: UUID
}

type JobLandingPage implements LandingPageInterfaceBase {
  id: UUID!
  createdAt: datetime!
  createdBy: String!
  jobName: String!
  statusName: String!
  startDate: Date
  endDate: Date
  description: String
  jobType: String
  requester: String
  jobOwner: String
}

type JobRelatedEntitiesResponse {
  preOpportunities: [PreOpportunityLiteResponse!]!
  contacts: [ContactResponse!]!
  companies: [CompanyResponse!]!
}

type JobStatusType {
  id: UUID!
  name: String!
}

type JobType {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  jobName: String!
  startDate: Date
  endDate: Date
  description: String
  jobType: String
  structuralDetails: String
  structuralInformation: String
  additionalInformation: String
  requesterId: UUID
  status: JobStatusType!
}

interface LandingPageInterfaceBase {
  id: UUID!
  createdAt: datetime!
  createdBy: String!
}

union LandingRecord = JobLandingPage | CompanyLandingPage | ContactLandingPage | PreOpportunityLandingPage

enum LandingSourceType {
  JOBS
  COMPANIES
  CONTACTS
  TASKS
  PRE_OPPORTUNITIES
}

input LinkRelationInput {
  sourceEntityType: EntityType!
  sourceEntityId: UUID!
  targetEntityType: EntityType!
  targetEntityId: UUID!
}

type LinkRelationType {
  id: UUID!
  sourceEntityType: EntityType!
  sourceEntityId: UUID!
  targetEntityType: EntityType!
  targetEntityId: UUID!
  createdAt: datetime!
  createdBy: UUID!
}

type Mutation {
  createJob(input: JobInput!): JobType!
  updateJob(id: UUID!, input: JobInput!): JobType!
  deleteJob(id: UUID!): Boolean!
  createTask(input: TaskInput!): TaskType!
  updateTask(id: UUID!, input: TaskInput!): TaskType!
  deleteTask(id: UUID!): Boolean!
  addTaskRelation(input: TaskRelationInput!): TaskRelationType!
  createNote(input: NoteInput!): NoteType!
  updateNote(id: UUID!, input: NoteInput!): NoteType!
  deleteNote(id: UUID!): Boolean!
  addNoteConversation(input: NoteConversationInput!): NoteConversationType!
  updateNoteConversation(input: NoteConversationInput!): NoteConversationType!
  deleteNoteConversations(noteId: UUID!): Boolean!
  createCompany(input: CompanyInput!): CompanyResponse!
  deleteCompany(id: UUID!): Boolean!
  updateCompany(id: UUID!, input: CompanyInput!): CompanyResponse!
  createContact(input: ContactInput!): ContactResponse!
  deleteContact(id: UUID!): Boolean!
  updateContact(id: UUID!, input: ContactInput!): ContactResponse!
  createLink(input: LinkRelationInput!): LinkRelationType!
  deleteLink(id: UUID!): Boolean!
  deleteLinkByEntities(input: DeleteLinkByEntitiesInput!): Boolean!
  createPreOpportunity(input: PreOpportunityInput!): PreOpportunityResponse!
  updatePreOpportunity(input: PreOpportunityInput!): PreOpportunityResponse!
  deletePreOpportunity(id: UUID!): Boolean!
}

input NoteConversationInput {
  noteId: UUID!
  content: String!
}

type NoteConversationType {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  noteId: UUID!
  content: String!
}

input NoteInput {
  title: String!
  content: String!
  tags: [String!]
  mentions: [UUID!]
}

type NoteType {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  title: String!
  content: String!
  tags: [String!]
  mentions: [UUID!]
  conversations: [NoteConversationType!]!
}

input OrderBy {
  columnName: String!
  direction: OrderByOperator!
}

enum OrderByOperator {
  ASC
  DESC
}

type PreOpportunityBalanceResponse {
  id: UUID!
  subtotal: Decimal!
  total: Decimal!
  quantity: Decimal!
  discount: Decimal!
  discountRate: Decimal!
}

input PreOpportunityDetailInput {
  quantity: Decimal!
  itemNumber: Int!
  unitPrice: Decimal!
  discountRate: Decimal!
  productId: UUID!
  endUserId: UUID!
  id: UUID = null
  productCpnId: UUID = null
  leadTime: String = null
}

type PreOpportunityDetailResponse {
  id: UUID!
  preOpportunityId: UUID!
  quantity: Decimal!
  itemNumber: Int!
  unitPrice: Decimal!
  subtotal: Decimal!
  discountRate: Decimal!
  discount: Decimal!
  total: Decimal!
  productId: UUID!
  productCpnId: UUID
  endUserId: UUID!
  leadTime: String
  product: ProductResponse!
}

input PreOpportunityInput {
  status: PreOpportunityStatus!
  entityNumber: String!
  entityDate: Date!
  soldToCustomerId: UUID!
  details: [PreOpportunityDetailInput!]!
  id: UUID
  expDate: Date
  reviseDate: Date
  acceptDate: Date
  soldToCustomerAddressId: UUID
  billToCustomerId: UUID
  billToCustomerAddressId: UUID
  jobId: UUID
  paymentTerms: String
  customerRef: String
  freightTerms: String
}

type PreOpportunityLandingPage implements LandingPageInterfaceBase {
  id: UUID!
  createdAt: datetime!
  createdBy: String!
  entityNumber: String!
  status: String!
  entityDate: Date!
  expDate: Date
  total: Decimal!
}

type PreOpportunityLiteResponse {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  status: PreOpportunityStatus!
  entityNumber: String!
  entityDate: Date!
  expDate: Date
  reviseDate: Date
  acceptDate: Date
  soldToCustomerId: UUID!
  soldToCustomerAddressId: UUID
  billToCustomerId: UUID
  billToCustomerAddressId: UUID
  jobId: UUID
  paymentTerms: String
  customerRef: String
  freightTerms: String
}

type PreOpportunityResponse {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  status: PreOpportunityStatus!
  entityNumber: String!
  entityDate: Date!
  expDate: Date
  reviseDate: Date
  acceptDate: Date
  soldToCustomerId: UUID!
  soldToCustomerAddressId: UUID
  billToCustomerId: UUID
  billToCustomerAddressId: UUID
  jobId: UUID
  paymentTerms: String
  customerRef: String
  freightTerms: String
  balance: PreOpportunityBalanceResponse!
  details: [PreOpportunityDetailResponse!]!
  job: JobType
}

enum PreOpportunityStatus {
  DRAFT
  PENDING
  APPROVED
  REJECTED
  CONVERTED
}

type ProductResponse {
  id: UUID!
  factoryId: UUID!
  factoryPartNumber: String!
}

type Query {
  job(id: UUID!): JobType!
  jobStatuses: [JobStatusType!]!
  jobRelatedEntities(jobId: UUID!): JobRelatedEntitiesResponse!
  jobSearch(searchTerm: String!, limit: Int! = 20): [JobType!]!
  jobsByContact(contactId: UUID!): [JobType!]!
  jobsByCompany(companyId: UUID!): [JobType!]!
  task(id: UUID!): TaskType!
  note(id: UUID!): NoteType!
  notes(limit: Int! = 20, offset: Int! = 0): [NoteType!]!
  notesByEntity(entityType: EntityType!, entityId: UUID!): [NoteType!]!
  noteConversations(noteId: UUID!): [NoteConversationType!]!
  company(id: UUID!): CompanyResponse!
  contact(id: UUID!): ContactResponse!
  contactsByCompany(companyId: UUID!): [ContactResponse!]!
  preOpportunity(id: UUID!): PreOpportunityResponse!
  productSearch(searchTerm: String!, factoryId: UUID, limit: Int! = 20): [ProductResponse!]!
  factorySearch(searchTerm: String!, published: Boolean! = true, limit: Int! = 20): [FactoryResponse!]!
  customerSearch(searchTerm: String!, published: Boolean! = true, limit: Int! = 20): [CustomerResponse!]!
  findLandingPages(sourceType: LandingSourceType!, filters: [Filter!] = null, orderBy: [OrderBy!] = null, limit: Int = 10, offset: Int = 0): GenericLandingPage!
}

enum RelatedEntityType {
  JOB
  CONTACT
  COMPANY
}

input TaskInput {
  title: String!
  status: TaskStatus!
  priority: TaskPriority!
  description: String
  assignedToId: UUID
  dueDate: Date
  tags: [String!]
}

enum TaskPriority {
  LOW
  NORMAL
  URGENT
  CRITICAL
}

input TaskRelationInput {
  taskId: UUID!
  relatedType: RelatedEntityType!
  relatedId: UUID!
}

type TaskRelationType {
  id: UUID!
  taskId: UUID!
  relatedType: RelatedEntityType!
  relatedId: UUID!
}

enum TaskStatus {
  TODO
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

type TaskType {
  id: UUID!
  createdAt: datetime!
  createdBy: UUID!
  title: String!
  status: TaskStatus!
  priority: TaskPriority!
  description: String
  assignedToId: UUID
  dueDate: Date
  tags: [String!]
}

scalar UUID

"""A date and time"""
scalar datetime
